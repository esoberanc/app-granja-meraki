
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Panel MT40 - Granja</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    async function cargarDatos() {
      try {
        const res = await fetch("/sensor-data");
        const data = await res.json();

        const campos = [
          ["power1", "AC Real Power (W)"],
          ["power2", "Humidificador Real Power (W)"],
          ["powerFactor1", "AC Power Factor (%)"],
          ["powerFactor2", "Humidificador Power Factor (%)"],
          ["apparentPower1", "AC Apparent Power (VA)"],
          ["apparentPower2", "Humidificador Apparent Power (VA)"],
          ["voltage1", "AC Voltaje (V)"],
          ["voltage2", "Humidificador Voltaje (V)"],
          ["current1", "AC Corriente (A)"],
          ["current2", "Humidificador Corriente (A)"],
          ["frequency1", "AC Frecuencia (Hz)"],
          ["frequency2", "Humidificador Frecuencia (Hz)"]
        ];

        campos.forEach(([key, label]) => {
          const el = document.getElementById(key);
          const valor = data[key];
          el.querySelector(".valor").textContent = valor !== undefined ? valor : "—";
          if (key.includes("powerFactor")) {
            el.className = valor >= 90
              ? "bg-green-200 rounded p-4 shadow"
              : valor >= 70
              ? "bg-yellow-200 rounded p-4 shadow"
              : "bg-red-200 rounded p-4 shadow";
          }
        });
      } catch (e) {
        alert("Error cargando datos MT40");
      }
    }

    setInterval(cargarDatos, 5000);
    window.onload = cargarDatos;
  </script>
</head>
<body class="bg-gray-100 p-6">
  <h1 class="text-2xl font-bold mb-4">📊 Panel Exclusivo MT40 - Tiempo Real</h1>
  <a href="/" class="text-blue-600 underline mb-4 inline-block">← Volver al Dashboard Principal</a>
  <div class="grid grid-cols-2 gap-4 max-w-5xl">
    <div id="power1" class="bg-white rounded p-4 shadow"><strong>AC Real Power (W):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="power2" class="bg-white rounded p-4 shadow"><strong>Humidificador Real Power (W):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="powerFactor1" class="bg-white rounded p-4 shadow"><strong>AC Power Factor (%):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="powerFactor2" class="bg-white rounded p-4 shadow"><strong>Humidificador Power Factor (%):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="apparentPower1" class="bg-white rounded p-4 shadow"><strong>AC Apparent Power (VA):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="apparentPower2" class="bg-white rounded p-4 shadow"><strong>Humidificador Apparent Power (VA):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="voltage1" class="bg-white rounded p-4 shadow"><strong>AC Voltaje (V):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="voltage2" class="bg-white rounded p-4 shadow"><strong>Humidificador Voltaje (V):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="current1" class="bg-white rounded p-4 shadow"><strong>AC Corriente (A):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="current2" class="bg-white rounded p-4 shadow"><strong>Humidificador Corriente (A):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="frequency1" class="bg-white rounded p-4 shadow"><strong>AC Frecuencia (Hz):</strong> <div class="valor text-xl font-mono">—</div></div>
    <div id="frequency2" class="bg-white rounded p-4 shadow"><strong>Humidificador Frecuencia (Hz):</strong> <div class="valor text-xl font-mono">—</div></div>
  </div>
</body>
</html>
